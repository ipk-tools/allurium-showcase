<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Allurium - Example 4: List of Widgets, Search and Usage</title>
  <!-- Link to Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <style>
    pre {
      background-color: #f8f9fa;
      padding: 1rem;
      border: 1px solid #dee2e6;
      border-radius: 0.25rem;
      overflow-x: auto;
    }
    code {
      font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
      font-size: 0.95em;
    }
    .section-title {
      margin-top: 2rem;
      margin-bottom: 1rem;
    }
    .nav-links a {
      margin: 0 1rem;
    }
    img {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <a class="navbar-brand" href="./../../index.html">Allurium</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav mx-auto">
            <li class="nav-item">
              <a class="nav-link" href="./../../quick_start.html">Quick Start</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./../../introduction.html">Intro</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./../../faq.html">FAQ</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./../../java_doc.html">Javadoc</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="https://github.com/ipk-tools/Allurium" target="_blank" rel="noopener noreferrer">Github</a>
            </li>
          </ul>
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="#">Eng</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./../../../rus/examples/accordionPassedTest/accordionPassedTest.html">Rus</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <!-- Hero Section -->
  <section id="home" class="bg-primary text-white text-center py-5">
    <div class="container">
      <h1 class="display-4">List of Widgets, Search and Usage</h1>
      <p class="lead">Example 4</p>
    </div>
  </section>

  <!-- Main Content Section -->
  <section id="examples" class="py-5">
    <div class="container">      
      <p>In the previous example, we learned how to work with lists of simple elements. However, most often when working with an interface you encounter sections grouped into blocks, i.e. widgets.</p>
      <p>These can be any kind of entities: table rows divided into cells by columns; image blocks with descriptions and metadata; list rows composed of several blocks with values; etc.</p>
      <p>For a clear example, let’s take a composite widget such as an <strong>Accordion</strong>.</p>
      
      <hr/>
      <iframe width="80%" height="650" src="./../../../examples_pages/accordion.html"></iframe>
      <hr/>
      
      <p>This is an excellent example because this complex widget consists of blocks that include only two elements: a header and the text inside the block. The logic is simple – when you click on a header, the corresponding block expands while the previous one collapses.</p>
      
      <h3 class="section-title">Selenide Version</h3>
      
      <p><strong>1. Define the Page Object</strong></p>
      <pre><code class="language-java">@Getter
@Accessors(fluent = true)
public class AccordionPage extends Page {

    protected ElementsCollection sections = $$(".card").as("Accordion sections");

    @Step("Click on {chapterName} in accordion widget")
    public SelenideElement clickOnSectionLabel(String chapterName) {
        SelenideElement chapterHead = sections.stream()
            .filter(section -> section.text().contains(chapterName))
            .findFirst().get()
            .$(".card-header button").as("Chapter head");
        chapterHead.click();
        return chapterHead;
    }

    @Step("Assert accordion's chapter {chapterName} has text {text}")
    public void assertTextHas(String chapterName, String text) {
        String targetText = sections.stream()
            .filter(section -> section.text().contains(chapterName))
            .findFirst().get()
            .$(".collapse .card-body").text();
        Assertions.assertThat(targetText).as("chapter content").contains(text);
    }
}
</code></pre>
      
      <p><strong>2. Create a test scenario in which you expand the accordion blocks in a different order and verify that the text blocks contain specific excerpts:</strong></p>
      <pre><code class="language-java">@Test
@Feature("List of widgets")
@DisplayName("Walk through accordion widget, asserting text patterns. All passed.")
public void accordionPassedTest() {
    Selenide.open(accordionPageUrl);
    accordionPage.clickOnSectionLabel("Chapter 2");
    accordionPage.clickOnSectionLabel("Chapter 3");
    accordionPage.clickOnSectionLabel("Chapter 4");
    accordionPage.clickOnSectionLabel("Chapter 5");
    accordionPage.clickOnSectionLabel("Chapter 1");
    accordionPage.assertTextHas("Chapter 1", "Once upon a time");
    accordionPage.clickOnSectionLabel("Chapter 2");
    accordionPage.assertTextHas("Chapter 2", "resided in the structured");
    accordionPage.clickOnSectionLabel("Chapter 3");
    accordionPage.assertTextHas("Chapter 3", "As Ajax traveled");
    accordionPage.clickOnSectionLabel("Chapter 4");
    accordionPage.assertTextHas("Chapter 4", "the art of dynamic typing");
    accordionPage.clickOnSectionLabel("Chapter 5");
    accordionPage.assertTextHas("Chapter 5", "As Ajax returned to the City");
}
</code></pre>
      
      <p>Let's view the Selenide Allure report:</p>
      <div class="text-center my-3">
        <img src="img/accordionPassedTest_selenide.jpg" alt="Selenide Report: Accordion" class="img-fluid">
      </div>
      
      <h3 class="section-title">Allurium Version</h3>
      
      <p><strong>1. Define the Page Object</strong></p>
      <pre><code class="language-java">@PageObject
@Getter
@Accessors(fluent = true)
public class AccordionPage extends Page {

    @Name("Accordion categories")
    @ListLocator(css = "#accordion .card")
    protected ListWC&lt;AccordionSection&gt; accordionSections = new ListWC&lt;&gt;();

    @Widget
    @Getter
    @Accessors(fluent = true)
    public static class AccordionSection extends AbstractWidget {

        @Name("Chapter name")
        @LocatorChain(css = "h5 button")
        protected Button title;

        @Name("Chapter story")
        @LocatorChain(css = ".collapse")
        protected Text textContent;

        public AccordionSection(SelenideElement root) {
            super(root);
        }

        @Override
        public String getId() {
            return title.text();
        }
    }
}
</code></pre>
      
      <p>In this case our class becomes more structured. The list of blocks is created using <code>ListWC</code>, and to describe the structure of an accordion block we use the class <code>AccordionSection</code>. Note the use of the <code>@LocatorChain</code> annotation to build a locator within the widget. By overriding the <code>getId()</code> method, we can extract widgets from the list by the header text, for example:</p>
      <pre><code class="language-java">accordionPage.accordionSections().get("Chapter 3").title().click();
</code></pre>
      
      <p><strong>2. Define the test scenario</strong></p>
      <pre><code class="language-java">@Test
@Feature("List of widgets")
@DisplayName("Walk through accordion widget, asserting text patterns. All passed.")
public void accordionPassedTest() {
    UiSteps.openBrowser(accordionPageUrl);
    accordionPage.accordionSections().get("Chapter 2").title().click();
    accordionPage.accordionSections().get("Chapter 3").title().click();
    accordionPage.accordionSections().get("Chapter 4").title().click();
    accordionPage.accordionSections().get("Chapter 5").title().click();
    accordionPage.accordionSections().get("Chapter 1").title().click();
    accordionPage.accordionSections().get("Chapter 1").textContent().assertHasText("Once upon a time");
    accordionPage.accordionSections().get("Chapter 2").title().click();
    accordionPage.accordionSections().get("Chapter 2").textContent().assertHasText("resided in the structured");
    accordionPage.accordionSections().get("Chapter 3").title().click();
    accordionPage.accordionSections().get("Chapter 3").textContent().assertHasText("As Ajax traveled");
    accordionPage.accordionSections().get("Chapter 4").title().click();
    accordionPage.accordionSections().get("Chapter 4").textContent().assertHasText("the art of dynamic typing");
    accordionPage.accordionSections().get("Chapter 5").title().click();
    accordionPage.accordionSections().get("Chapter 5").textContent().assertHasText("As Ajax returned to the City");
}
</code></pre>
      
      <p>Thus, we did not have to describe search via filters and manual logging of steps – everything happens automatically.</p>
      
      <div class="text-center my-3">
        <img src="img/accordionPassedTest_allurium.jpg" alt="Allurium Report: Accordion" class="img-fluid">
      </div>
      
      <!-- Navigation Links -->
      <div class="nav-links text-center mt-5">
        <a href="./../multiLevelMenuNavigation/multiLevelMenuNavigation.html" class="btn btn-outline-secondary">
          &laquo;&nbsp; Navigation Through Dropdown Menu
        </a>
        <a href="./../accordionFailedTest/accordionFailedTest.html" class="btn btn-outline-secondary">
          List of Widgets, Search and Usage &nbsp;&raquo;
        </a>
      </div>
      
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-dark text-white text-center py-4">
    <div class="container">
        <p>&copy; 2025 Allurium - distributed under the MIT license</p>
    </div>
  </footer>

  <!-- Bootstrap JS (Optional) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" 
          integrity="sha384-pzjw8f+ua7Kw1TIq0LkBbf2jOq/dKbX4iXkLppInR8p9lE5f/vp6LFh8S3y9r96f" 
          crossorigin="anonymous"></script>
</body>
</html>
